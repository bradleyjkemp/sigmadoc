---
title: "WScript or CScript Dropper"
aliases:
  - "/rule/cea72823-df4d-4567-950c-0b579eaf0846"

tags:
  - attack.execution
  - attack.t1059.005
  - attack.t1059.007
  - attack.defense_evasion
  - attack.t1064



status: experimental



level: high



date: Wed, 16 Jan 2019 23:36:31 +0100


---

Detects wscript/cscript executions of scripts located in user directories

<!--more-->


## Known false-positives

* Winzip
* Other self-extractors




## Raw rule
```yaml
title: WScript or CScript Dropper
id: cea72823-df4d-4567-950c-0b579eaf0846
status: experimental
description: Detects wscript/cscript executions of scripts located in user directories
author: Margaritis Dimitrios (idea), Florian Roth (rule)
date: 2019/01/16
modified: 2020/09/01
tags:
    - attack.execution
    - attack.t1059.005
    - attack.t1059.007
    - attack.defense_evasion  # an old one
    - attack.t1064  # an old one
logsource:
    category: process_creation
    product: windows
detection:
    selection:
        Image:
            - '*\wscript.exe'
            - '*\cscript.exe'
        CommandLine:
            - '* C:\Users\\*.jse *'
            - '* C:\Users\\*.vbe *'
            - '* C:\Users\\*.js *'
            - '* C:\Users\\*.vba *'
            - '* C:\Users\\*.vbs *'
            - '* C:\ProgramData\\*.jse *'
            - '* C:\ProgramData\\*.vbe *'
            - '* C:\ProgramData\\*.js *'
            - '* C:\ProgramData\\*.vba *'
            - '* C:\ProgramData\\*.vbs *'
    falsepositive:
        ParentImage: '*\winzip*'
    condition: selection and not falsepositive
fields:
    - CommandLine
    - ParentCommandLine
falsepositives:
    - Winzip
    - Other self-extractors
level: high

```

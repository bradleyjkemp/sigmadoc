<!doctype html><html lang=en><head><meta charset=utf-8><title>Sigma Rule Browser</title><meta name=viewport content="width=device-width"><link rel=icon type=image/png sizes=32x32 href=../images/favicon.png><link rel=stylesheet href=https://unpkg.com/bulma@0.9.2/css/bulma.min.css><script src=https://kit.fontawesome.com/7dc3015a44.js crossorigin=anonymous></script></head><body><nav class=navbar role=navigation aria-label="main navigation"><div class=navbar-brand><a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc/>Sigma Docs</a>
<a role=button class=navbar-burger aria-label=menu aria-expanded=false data-target=navbarBasicExample><span aria-hidden=true></span><span aria-hidden=true></span><span aria-hidden=true></span></a></div><div id=navbarBasicExample class=navbar-menu><div class=navbar-start><a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc/>Home</a>
<a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc//rules/>Rules</a>
<a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc//configs/>Configs</a><div class="navbar-item has-dropdown is-hoverable"><a class=navbar-link>Explore rules by...</a><div class=navbar-dropdown><a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc//tags/>Tag</a>
<a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc//status/>Status</a>
<a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc//level/>Level</a></div></div></div><div class=navbar-end><div class=navbar-item id=search class=bd-search><form action=https://bradleyjkemp.dev/sigmadoc//search><p class="control has-icons-left"><input class="input is-rounded" type=text name=query placeholder=Search>
<span class="icon is-left"><i class="fas fa-search" aria-hidden=true></i></span></p></form></div></div></div></nav><section class=section><div class=container><div class=columns><div class="column is-9"><nav class=breadcrumb aria-label=breadcrumbs><ul><li><a href=https://bradleyjkemp.dev/sigmadoc/>home</a></li><li><a href=https://bradleyjkemp.dev/sigmadoc/rules/>rules</a></li><li><a href=https://bradleyjkemp.dev/sigmadoc/rules/windows/>windows</a></li><li><a href=https://bradleyjkemp.dev/sigmadoc/rules/windows/file_event/>file_event</a></li><li><a href=https://bradleyjkemp.dev/sigmadoc/rules/windows/file_event/file_event_win_powershell_startup_shortcuts.yml/>file_event_win_powershell_startup_shortcuts.yml</a></li></ul></nav><div class="content is-medium"><h3 class="title is-1">PowerShell Writing Startup Shortcuts</h3><div class=box><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-medium is-dark">level</span>
<span class="tag is-medium is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-medium is-dark">status</span>
<span class="tag is-medium is-danger is-light">experimental</span></div></div></div><p>Attempts to detect PowerShell writing startup shortcuts. This procedure was highlighted in Red Canary Intel Insights Oct. 2021, &ldquo;We frequently observe adversaries using PowerShell to write malicious .lnk files into the startup directory to establish persistence. Accordingly, this detection opportunity is likely to identify persistence mechanisms in multiple threats. In the context of Yellow Cockatoo, this persistence mechanism eventually launches the command-line script that leads to the installation of a malicious DLL&rdquo;</p><h2 id=known-false-positives>Known false-positives</h2><ul><li>Unknown</li><li>Depending on your environment accepted applications may leverage this at times. It is recomended to search for anomolies inidicative of malware.</li></ul><h2 id=references>References</h2><ul><li><a href=https://redcanary.com/blog/intelligence-insights-october-2021/>https://redcanary.com/blog/intelligence-insights-october-2021/</a></li><li><a href=https://github.com/redcanaryco/atomic-red-team/blob/36d49de4c8b00bf36054294b4a1fcbab3917d7c5/atomics/T1547.001/T1547.001.md#atomic-test-7---add-executable-shortcut-link-to-user-startup-folder>https://github.com/redcanaryco/atomic-red-team/blob/36d49de4c8b00bf36054294b4a1fcbab3917d7c5/atomics/T1547.001/T1547.001.md#atomic-test-7---add-executable-shortcut-link-to-user-startup-folder</a></li></ul><h2 id=raw-rule-edithttpsgithubcomsigmahqsigmaeditmasterruleswindowsfile_eventfile_event_win_powershell_startup_shortcutsyml>Raw rule (<a href=https://github.com/SigmaHQ/sigma/edit/master/rules/windows/file_event/file_event_win_powershell_startup_shortcuts.yml>edit</a>)</h2><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>title</span>: <span style=color:#ae81ff>PowerShell Writing Startup Shortcuts</span>
<span style=color:#f92672>id</span>: <span style=color:#ae81ff>92fa78e7-4d39-45f1-91a3-8b23f3f1088d</span>
<span style=color:#f92672>description</span>: <span style=color:#ae81ff>Attempts to detect PowerShell writing startup shortcuts. This procedure was highlighted in Red Canary Intel Insights Oct. 2021, &#34;We frequently observe adversaries using PowerShell to write malicious .lnk files into the startup directory to establish persistence. Accordingly, this detection opportunity is likely to identify persistence mechanisms in multiple threats. In the context of Yellow Cockatoo, this persistence mechanism eventually launches the command-line script that leads to the installation of a malicious DLL&#34;</span>
<span style=color:#f92672>status</span>: <span style=color:#ae81ff>experimental</span>
<span style=color:#f92672>references</span>: 
    - <span style=color:#ae81ff>https://redcanary.com/blog/intelligence-insights-october-2021/</span>
    - <span style=color:#ae81ff>https://github.com/redcanaryco/atomic-red-team/blob/36d49de4c8b00bf36054294b4a1fcbab3917d7c5/atomics/T1547.001/T1547.001.md#atomic-test-7---add-executable-shortcut-link-to-user-startup-folder</span>
<span style=color:#f92672>tags</span>:
    - <span style=color:#ae81ff>attack.registry_run_keys_/_startup_folder</span>
    - <span style=color:#ae81ff>attack.t1547.001</span>
<span style=color:#f92672>date</span>: <span style=color:#ae81ff>2021</span><span style=color:#ae81ff>/10/24</span>
<span style=color:#f92672>author</span>: <span style=color:#ae81ff>Christopher Peacock &#39;@securepeacock&#39;, SCYTHE</span>
<span style=color:#f92672>level</span>: <span style=color:#ae81ff>high</span>
<span style=color:#f92672>logsource</span>:
    <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
    <span style=color:#f92672>category</span>: <span style=color:#ae81ff>file_event</span>
<span style=color:#f92672>detection</span>:
    <span style=color:#f92672>selection</span>:
        <span style=color:#f92672>Image|endswith</span>: <span style=color:#e6db74>&#39;\powershell.exe&#39;</span>
        <span style=color:#f92672>TargetFilename|contains</span>: <span style=color:#e6db74>&#39;\start menu\programs\startup\&#39;
</span><span style=color:#e6db74>        TargetFilename|endswith: &#39;</span><span style=color:#ae81ff>.lnk&#39;</span>
    <span style=color:#f92672>condition</span>: <span style=color:#ae81ff>selection</span>
<span style=color:#f92672>falsepositives</span>:
    - <span style=color:#ae81ff>Unknown</span>
    - <span style=color:#ae81ff>Depending on your environment accepted applications may leverage this at times. It is recomended to search for anomolies inidicative of malware.</span>

</code></pre></div></div></div></div><div class="column is-3"><aside class="menu is-medium"><p class=menu-label>Rule Tags</p><div class=tags><a href=https://bradleyjkemp.dev/sigmadoc//tags/attack.registry_run_keys_/_startup_folder class="tag is-medium">attack.registry_run_keys_/_startup_folder</a></a>
<a href=https://bradleyjkemp.dev/sigmadoc//tags/attack.t1547.001 class="tag is-medium">attack.t1547.001</a></a></div><ul class=menu-list></ul><p class=menu-label>Similar rules</p><ul class=menu-list><li><a href=/sigmadoc/rules/windows/process_creation/proc_creation_win_malware_ryuk.yml/>Ryuk Ransomware</a></li><li><a href=/sigmadoc/rules/windows/process_creation/proc_creation_win_susp_direct_asep_reg_keys_modification.yml/>Direct Autorun Keys Modification</a></li><li><a href=/sigmadoc/rules/windows/registry_event/registry_event_narrator_feedback_persistance.yml/>Narrator's Feedback-Hub Persistence</a></li><li><a href=/sigmadoc/rules/windows/registry_event/registry_event_apt_leviathan.yml/>Leviathan Registry Key Activity</a></li><li><a href=/sigmadoc/rules/windows/process_creation/proc_creation_win_reg_add_run_key.yml/>Reg Add RUN Key</a></li></ul></aside></div></div></div></section><footer class=footer><div class="content has-text-centered"><p>Site generated with <a href=https://github.com/bradleyjkemp/sigmadoc><strong>sigmadoc</strong></a>. The website content
is licensed <a href=https://github.com/SigmaHQ/sigma/blob/master/LICENSE.Detection.Rules.md>DRL 1.0</a>.</p></div></footer></body></html>
<!doctype html><html lang=en><head><meta charset=utf-8><title>Sigma Rule Browser</title><meta name=viewport content="width=device-width"><link rel=icon type=image/png sizes=32x32 href=../images/favicon.png><link rel=stylesheet href=https://unpkg.com/bulma@0.9.2/css/bulma.min.css><script src=https://kit.fontawesome.com/7dc3015a44.js crossorigin=anonymous></script></head><body><nav class=navbar role=navigation aria-label="main navigation"><div class=navbar-brand><a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc/>Sigma Docs</a>
<a role=button class=navbar-burger aria-label=menu aria-expanded=false data-target=navbarBasicExample><span aria-hidden=true></span><span aria-hidden=true></span><span aria-hidden=true></span></a></div><div id=navbarBasicExample class=navbar-menu><div class=navbar-start><a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc/>Home</a>
<a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc//rules/>Rules</a>
<a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc//configs/>Configs</a><div class="navbar-item has-dropdown is-hoverable"><a class=navbar-link>Explore rules by...</a><div class=navbar-dropdown><a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc//tags/>Tag</a>
<a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc//status/>Status</a>
<a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc//level/>Level</a></div></div></div><div class=navbar-end><div class=navbar-item id=search class=bd-search><form action=https://bradleyjkemp.dev/sigmadoc//search><p class="control has-icons-left"><input class="input is-rounded" type=text name=query placeholder=Search>
<span class="icon is-left"><i class="fas fa-search" aria-hidden=true></i></span></p></form></div></div></div></nav><section class=section><div class=container><div class=columns><div class="column is-9"><nav class=breadcrumb aria-label=breadcrumbs><ul><li><a href=https://bradleyjkemp.dev/sigmadoc/>home</a></li><li><a href=https://bradleyjkemp.dev/sigmadoc/rules/>rules</a></li><li><a href=https://bradleyjkemp.dev/sigmadoc/rules/windows/>windows</a></li><li><a href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/>process_creation</a></li><li><a href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_lolbin_execution_via_winget.yml/>proc_creation_win_lolbin_execution_via_winget.yml</a></li></ul></nav><div class="content is-medium"><h3 class="title is-1">Monitoring Winget For LOLbin Execution</h3><div class=box><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-medium is-dark">level</span>
<span class="tag is-medium is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-medium is-dark">status</span>
<span class="tag is-medium is-danger is-light">experimental</span></div></div></div><p>Adversaries can abuse winget to download payloads remotely and execute them without touching disk. Winget will be included by default in Windows 10 and is already available in Windows 10 insider programs. The manifest option enables you to install an application by passing in a YAML file directly to the client. Winget can be used to download and install exe&rsquo;s, msi, msix files later.</p><h2 id=known-false-positives>Known false-positives</h2><ul><li>Admin activity installing packages not in the official Microsoft repo. Winget probably won&rsquo;t be used by most users.</li></ul><h2 id=references>References</h2><ul><li><a href=https://docs.microsoft.com/en-us/windows/package-manager/winget/install#local-install>https://docs.microsoft.com/en-us/windows/package-manager/winget/install#local-install</a></li></ul><h2 id=raw-rule-edithttpsgithubcomsigmahqsigmaeditmasterruleswindowsprocess_creationproc_creation_win_lolbin_execution_via_wingetyml>Raw rule (<a href=https://github.com/SigmaHQ/sigma/edit/master/rules/windows/process_creation/proc_creation_win_lolbin_execution_via_winget.yml>edit</a>)</h2><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>title</span>: <span style=color:#ae81ff>Monitoring Winget For LOLbin Execution</span>
<span style=color:#f92672>id</span>: <span style=color:#ae81ff>313d6012-51a0-4d93-8dfc-de8553239e25</span>
<span style=color:#f92672>description</span>: <span style=color:#ae81ff>Adversaries can abuse winget to download payloads remotely and execute them without touching disk. Winget will be included by default in Windows 10 and is already available in Windows 10 insider programs. The manifest option enables you to install an application by passing in a YAML file directly to the client. Winget can be used to download and install exe&#39;s, msi, msix files later.</span>
<span style=color:#f92672>status</span>: <span style=color:#ae81ff>experimental</span>
<span style=color:#f92672>references</span>: 
    - <span style=color:#ae81ff>https://docs.microsoft.com/en-us/windows/package-manager/winget/install#local-install</span>
<span style=color:#f92672>author</span>: <span style=color:#ae81ff>Sreeman, Florian Roth, Frack113</span>
<span style=color:#f92672>date</span>: <span style=color:#ae81ff>2020</span><span style=color:#ae81ff>/04/21</span>
<span style=color:#f92672>modified</span>: <span style=color:#ae81ff>2022</span><span style=color:#ae81ff>/01/11</span>
<span style=color:#f92672>tags</span>:
    - <span style=color:#ae81ff>attack.defense_evasion</span>
    - <span style=color:#ae81ff>attack.execution</span>
    - <span style=color:#ae81ff>attack.t1059</span>
<span style=color:#f92672>logsource</span>:
    <span style=color:#f92672>category</span>: <span style=color:#ae81ff>process_creation</span>
    <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
<span style=color:#f92672>detection</span>:
    <span style=color:#f92672>selection</span>:
        <span style=color:#f92672>CommandLine|contains|all</span>: 
            - <span style=color:#e6db74>&#39;winget&#39;</span>
            - <span style=color:#e6db74>&#39;install&#39;</span>
        <span style=color:#f92672>CommandLine|contains</span>:
            - <span style=color:#e6db74>&#39;-m &#39;</span>
            - <span style=color:#e6db74>&#39;--manifest&#39;</span>
    <span style=color:#f92672>condition</span>: <span style=color:#ae81ff>selection</span>
<span style=color:#f92672>falsepositives</span>:
    - <span style=color:#ae81ff>Admin activity installing packages not in the official Microsoft repo. Winget probably won&#39;t be used by most users.</span>
<span style=color:#f92672>fields</span>:
    - <span style=color:#ae81ff>CommandLine</span>
<span style=color:#f92672>level</span>: <span style=color:#ae81ff>medium</span>

</code></pre></div></div></div></div><div class="column is-3"><aside class="menu is-medium"><p class=menu-label>Rule Tags</p><div class=tags><a href=https://bradleyjkemp.dev/sigmadoc//tags/attack.defense_evasion class="tag is-medium">attack.defense_evasion</a></a>
<a href=https://bradleyjkemp.dev/sigmadoc//tags/attack.execution class="tag is-medium">attack.execution</a></a>
<a href=https://bradleyjkemp.dev/sigmadoc//tags/attack.t1059 class="tag is-medium">attack.t1059</a></a></div><ul class=menu-list></ul><p class=menu-label>Similar rules</p><ul class=menu-list><li><a href=/sigmadoc/rules/windows/process_creation/proc_creation_win_susp_rasdial_activity.yml/>Suspicious RASdial Activity</a></li><li><a href=/sigmadoc/rules/windows/process_creation/proc_creation_win_run_powershell_script_from_input_stream.yml/>Run PowerShell Script from Redirected Input Stream</a></li><li><a href=/sigmadoc/rules/windows/process_creation/proc_creation_win_susp_runscripthelper.yml/>Suspicious Runscripthelper.exe</a></li><li><a href=/sigmadoc/rules/windows/process_creation/proc_creation_win_susp_ftp.yml/>Suspicious ftp.exe</a></li><li><a href=/sigmadoc/rules/windows/process_creation/proc_creation_win_cmd_dosfuscation.yml/>Suspicious Dosfuscation Character in Commandline</a></li></ul></aside></div></div></div></section><footer class=footer><div class="content has-text-centered"><p>Site generated with <a href=https://github.com/bradleyjkemp/sigmadoc><strong>sigmadoc</strong></a>. The website content
is licensed <a href=https://github.com/SigmaHQ/sigma/blob/master/LICENSE.Detection.Rules.md>DRL 1.0</a>.</p></div></footer></body></html>
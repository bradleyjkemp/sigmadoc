<!doctype html><html lang=en><head><meta charset=utf-8><title>Sigma Rule Browser</title><meta name=viewport content="width=device-width"><link rel=icon type=image/png sizes=32x32 href=../images/favicon.png><link rel=stylesheet href=https://unpkg.com/bulma@0.9.2/css/bulma.min.css><script src=https://kit.fontawesome.com/7dc3015a44.js crossorigin=anonymous></script></head><body><nav class=navbar role=navigation aria-label="main navigation"><div class=navbar-brand><a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc/>Sigma Docs</a>
<a role=button class=navbar-burger aria-label=menu aria-expanded=false data-target=navbarBasicExample><span aria-hidden=true></span><span aria-hidden=true></span><span aria-hidden=true></span></a></div><div id=navbarBasicExample class=navbar-menu><div class=navbar-start><a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc/>Home</a>
<a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc//rules/>Rules</a>
<a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc//configs/>Configs</a><div class="navbar-item has-dropdown is-hoverable"><a class=navbar-link>Explore rules by...</a><div class=navbar-dropdown><a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc//tags/>Tag</a>
<a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc//status/>Status</a>
<a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc//level/>Level</a></div></div></div><div class=navbar-end><div class=navbar-item id=search class=bd-search><form action=https://bradleyjkemp.dev/sigmadoc//search><p class="control has-icons-left"><input class="input is-rounded" type=text name=query placeholder=Search>
<span class="icon is-left"><i class="fas fa-search" aria-hidden=true></i></span></p></form></div></div></div></nav><section class=section><div class=container><div class=columns><div class="column is-9"><nav class=breadcrumb aria-label=breadcrumbs><ul><li><a href=https://bradleyjkemp.dev/sigmadoc/>home</a></li><li><a href=https://bradleyjkemp.dev/sigmadoc/rules/>rules</a></li><li><a href=https://bradleyjkemp.dev/sigmadoc/rules/windows/>windows</a></li><li><a href=https://bradleyjkemp.dev/sigmadoc/rules/windows/powershell/>powershell</a></li><li><a href=https://bradleyjkemp.dev/sigmadoc/rules/windows/powershell/powershell_script/>powershell_script</a></li><li><a href=https://bradleyjkemp.dev/sigmadoc/rules/windows/powershell/powershell_script/posh_ps_suspicious_execute_batch_script.yml/>posh_ps_suspicious_execute_batch_script.yml</a></li></ul></nav><div class="content is-medium"><h3 class="title is-1">Powershell Execute Batch Script</h3><div class=box><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-medium is-dark">level</span>
<span class="tag is-medium is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-medium is-dark">status</span>
<span class="tag is-medium is-danger is-light">experimental</span></div></div></div><p>Adversaries may abuse the Windows command shell for execution.
The Windows command shell (<a href=https://attack.mitre.org/software/S0106>cmd</a>) is the primary command prompt on Windows systems.
The Windows command prompt can be used to control almost any aspect of a system, with various permission levels required for different subsets of commands.
Batch files (ex: .bat or .cmd) also provide the shell with a list of sequential commands to run, as well as normal scripting operations such as conditionals and loops.
Common uses of batch files include long or repetitive tasks, or the need to run the same set of commands on multiple system</p><h2 id=known-false-positives>Known false-positives</h2><ul><li>legitim administration script</li></ul><h2 id=references>References</h2><ul><li><a href=https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1059.003/T1059.003.md#atomic-test-1---create-and-execute-batch-script>https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1059.003/T1059.003.md#atomic-test-1---create-and-execute-batch-script</a></li></ul><h2 id=raw-rule-edithttpsgithubcomsigmahqsigmaeditmasterruleswindowspowershellpowershell_scriptposh_ps_suspicious_execute_batch_scriptyml>Raw rule (<a href=https://github.com/SigmaHQ/sigma/edit/master/rules/windows/powershell/powershell_script/posh_ps_suspicious_execute_batch_script.yml>edit</a>)</h2><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>title</span>: <span style=color:#ae81ff>Powershell Execute Batch Script</span>
<span style=color:#f92672>id</span>: <span style=color:#ae81ff>b5522a23-82da-44e5-9c8b-e10ed8955f88</span>
<span style=color:#f92672>description</span>: |<span style=color:#e6db74>
</span><span style=color:#e6db74>  Adversaries may abuse the Windows command shell for execution.
</span><span style=color:#e6db74>  The Windows command shell ([cmd](https://attack.mitre.org/software/S0106)) is the primary command prompt on Windows systems.
</span><span style=color:#e6db74>  The Windows command prompt can be used to control almost any aspect of a system, with various permission levels required for different subsets of commands.
</span><span style=color:#e6db74>  Batch files (ex: .bat or .cmd) also provide the shell with a list of sequential commands to run, as well as normal scripting operations such as conditionals and loops.
</span><span style=color:#e6db74>  Common uses of batch files include long or repetitive tasks, or the need to run the same set of commands on multiple system</span>  
<span style=color:#f92672>references</span>:
    - <span style=color:#ae81ff>https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1059.003/T1059.003.md#atomic-test-1---create-and-execute-batch-script</span>
<span style=color:#f92672>status</span>: <span style=color:#ae81ff>experimental</span>
<span style=color:#f92672>author</span>: <span style=color:#ae81ff>frack113</span>
<span style=color:#f92672>date</span>: <span style=color:#ae81ff>2022</span><span style=color:#ae81ff>/01/02</span>
<span style=color:#f92672>logsource</span>:
    <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
    <span style=color:#f92672>category</span>: <span style=color:#ae81ff>ps_script</span>
<span style=color:#f92672>detection</span>:
    <span style=color:#f92672>selection_start</span>:
        <span style=color:#f92672>ScriptBlockText|contains</span>: <span style=color:#ae81ff>Start-Process</span>
    <span style=color:#f92672>selection_batch</span>:
        <span style=color:#f92672>ScriptBlockText|contains</span>: 
            - <span style=color:#e6db74>&#39;.cmd&#39;</span> 
            - <span style=color:#e6db74>&#39;.bat&#39;</span>
    <span style=color:#f92672>condition</span>: <span style=color:#ae81ff>all of selection_*</span>
<span style=color:#f92672>falsepositives</span>:
    - <span style=color:#ae81ff>legitim administration script</span>
<span style=color:#f92672>level</span>: <span style=color:#ae81ff>medium</span>
<span style=color:#f92672>tags</span>:
    - <span style=color:#ae81ff>attack.execution</span>
    - <span style=color:#ae81ff>attack.t1059.003</span>
</code></pre></div></div></div></div><div class="column is-3"><aside class="menu is-medium"><p class=menu-label>Rule Tags</p><div class=tags><a href=https://bradleyjkemp.dev/sigmadoc//tags/attack.execution class="tag is-medium">attack.execution</a></a>
<a href=https://bradleyjkemp.dev/sigmadoc//tags/attack.t1059.003 class="tag is-medium">attack.t1059.003</a></a></div><ul class=menu-list></ul><p class=menu-label>Similar rules</p><ul class=menu-list><li><a href=/sigmadoc/rules/windows/builtin/applocker/win_applocker_file_was_not_allowed_to_run.yml/>File Was Not Allowed To Run</a></li><li><a href=/sigmadoc/rules/windows/process_creation/proc_creation_win_commandline_path_traversal.yml/>Cmd.exe CommandLine Path Traversal</a></li><li><a href=/sigmadoc/rules/windows/process_creation/proc_creation_win_exploit_cve_2020_10189.yml/>Exploited CVE-2020-10189 Zoho ManageEngine</a></li><li><a href=/sigmadoc/rules/windows/process_creation/proc_creation_win_hack_koadic.yml/>Koadic Execution</a></li><li><a href=/sigmadoc/rules/cloud/aws/aws_ec2_startup_script_change.yml/>AWS EC2 Startup Shell Script Change</a></li></ul></aside></div></div></div></section><footer class=footer><div class="content has-text-centered"><p>Site generated with <a href=https://github.com/bradleyjkemp/sigmadoc><strong>sigmadoc</strong></a>. The website content
is licensed <a href=https://github.com/SigmaHQ/sigma/blob/master/LICENSE.Detection.Rules.md>DRL 1.0</a>.</p></div></footer></body></html>
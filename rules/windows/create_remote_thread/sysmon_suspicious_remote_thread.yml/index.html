<!doctype html><html lang=en><head><meta charset=utf-8><title>Sigma Rule Browser</title><meta name=viewport content="width=device-width"><link rel=icon type=image/png sizes=32x32 href=../images/favicon.png><link rel=stylesheet href=https://unpkg.com/bulma@0.9.2/css/bulma.min.css><script src=https://kit.fontawesome.com/7dc3015a44.js crossorigin=anonymous></script></head><body><nav class=navbar role=navigation aria-label="main navigation"><div class=navbar-brand><a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc/>Sigma Docs</a>
<a role=button class=navbar-burger aria-label=menu aria-expanded=false data-target=navbarBasicExample><span aria-hidden=true></span><span aria-hidden=true></span><span aria-hidden=true></span></a></div><div id=navbarBasicExample class=navbar-menu><div class=navbar-start><a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc/>Home</a>
<a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc//rules/>Rules</a>
<a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc//configs/>Configs</a><div class="navbar-item has-dropdown is-hoverable"><a class=navbar-link>Explore rules by...</a><div class=navbar-dropdown><a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc//tags/>Tag</a>
<a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc//status/>Status</a>
<a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc//level/>Level</a></div></div></div><div class=navbar-end><div class=navbar-item id=search class=bd-search><form action=https://bradleyjkemp.dev/sigmadoc//search><p class="control has-icons-left"><input class="input is-rounded" type=text name=query placeholder=Search>
<span class="icon is-left"><i class="fas fa-search" aria-hidden=true></i></span></p></form></div></div></div></nav><section class=section><div class=container><div class=columns><div class="column is-9"><nav class=breadcrumb aria-label=breadcrumbs><ul><li><a href=https://bradleyjkemp.dev/sigmadoc/>home</a></li><li><a href=https://bradleyjkemp.dev/sigmadoc/rules/>rules</a></li><li><a href=https://bradleyjkemp.dev/sigmadoc/rules/windows/>windows</a></li><li><a href=https://bradleyjkemp.dev/sigmadoc/rules/windows/create_remote_thread/>create_remote_thread</a></li><li><a href=https://bradleyjkemp.dev/sigmadoc/rules/windows/create_remote_thread/sysmon_suspicious_remote_thread.yml/>sysmon_suspicious_remote_thread.yml</a></li></ul></nav><div class="content is-medium"><h3 class="title is-1">Suspicious Remote Thread Created</h3><div class=box><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-medium is-dark">level</span>
<span class="tag is-medium is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-medium is-dark">status</span>
<span class="tag is-medium is-danger is-light">experimental</span></div></div></div><p>Offensive tradecraft is switching away from using APIs like &ldquo;CreateRemoteThread&rdquo;, however, this is still largely observed in the wild. This rule aims to detect suspicious processes (those we would not expect to behave in this way like word.exe or outlook.exe) creating remote threads on other processes. It is a generalistic rule, but it should have a low FP ratio due to the selected range of processes.</p><h2 id=known-false-positives>Known false-positives</h2><ul><li>Unknown</li></ul><h2 id=references>References</h2><ul><li>Personal research, statistical analysis</li><li><a href=https://lolbas-project.github.io>https://lolbas-project.github.io</a></li></ul><h2 id=raw-rule-edithttpsgithubcomsigmahqsigmaeditmasterruleswindowscreate_remote_threadsysmon_suspicious_remote_threadyml>Raw rule (<a href=https://github.com/SigmaHQ/sigma/edit/master/rules/windows/create_remote_thread/sysmon_suspicious_remote_thread.yml>edit</a>)</h2><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>title</span>: <span style=color:#ae81ff>Suspicious Remote Thread Created</span>
<span style=color:#f92672>id</span>: <span style=color:#ae81ff>66d31e5f-52d6-40a4-9615-002d3789a119</span>
<span style=color:#f92672>description</span>: <span style=color:#ae81ff>Offensive tradecraft is switching away from using APIs like &#34;CreateRemoteThread&#34;, however, this is still largely observed in the wild. This rule aims</span>
    <span style=color:#ae81ff>to detect suspicious processes (those we would not expect to behave in this way like word.exe or outlook.exe) creating remote threads on other processes. It is</span>
    <span style=color:#ae81ff>a generalistic rule, but it should have a low FP ratio due to the selected range of processes.</span>
<span style=color:#f92672>notes</span>:
    - <span style=color:#ae81ff>MonitoringHost.exe is a process that loads .NET CLR by default and thus a favorite for process injection for .NET in-memory offensive tools.</span>
<span style=color:#f92672>status</span>: <span style=color:#ae81ff>experimental</span>
<span style=color:#f92672>date</span>: <span style=color:#ae81ff>2019</span><span style=color:#ae81ff>/10/27</span>
<span style=color:#f92672>modified</span>: <span style=color:#ae81ff>2021</span><span style=color:#ae81ff>/06/27</span>
<span style=color:#f92672>author</span>: <span style=color:#ae81ff>Perez Diego (@darkquassar), oscd.community</span>
<span style=color:#f92672>references</span>:
    - <span style=color:#ae81ff>Personal research, statistical analysis</span>
    - <span style=color:#ae81ff>https://lolbas-project.github.io</span>
<span style=color:#f92672>logsource</span>:
    <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
    <span style=color:#f92672>category</span>: <span style=color:#ae81ff>create_remote_thread</span>
<span style=color:#f92672>tags</span>:
    - <span style=color:#ae81ff>attack.privilege_escalation</span>
    - <span style=color:#ae81ff>attack.defense_evasion</span>
    - <span style=color:#ae81ff>attack.t1055</span>
<span style=color:#f92672>detection</span>:
    <span style=color:#f92672>selection</span>: 
        <span style=color:#f92672>SourceImage|endswith</span>:
            - <span style=color:#e6db74>&#39;\bash.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\cvtres.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\defrag.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\dnx.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\esentutl.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\excel.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\expand.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\explorer.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\find.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\findstr.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\forfiles.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\git.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\gpupdate.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\hh.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\iexplore.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\installutil.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\lync.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\makecab.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\mDNSResponder.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\monitoringhost.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\msbuild.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\mshta.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\msiexec.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\mspaint.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\outlook.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\ping.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\powerpnt.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\powershell.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\provtool.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\python.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\regsvr32.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\robocopy.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\runonce.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\sapcimc.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\schtasks.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\smartscreen.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\spoolsv.exe&#39;</span>
            <span style=color:#75715e># - &#39;\taskhost.exe&#39;  # disabled due to false positives</span>
            - <span style=color:#e6db74>&#39;\tstheme.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\userinit.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\vssadmin.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\vssvc.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\w3wp.exe&#39;</span>       
            - <span style=color:#e6db74>&#39;\winlogon.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\winscp.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\wmic.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\word.exe&#39;</span>
            - <span style=color:#e6db74>&#39;\wscript.exe&#39;</span>
    <span style=color:#f92672>filter</span>:
        <span style=color:#f92672>SourceImage|contains</span>: <span style=color:#e6db74>&#39;Visual Studio&#39;</span>
    <span style=color:#f92672>condition</span>: <span style=color:#ae81ff>selection and not filter</span>
<span style=color:#f92672>fields</span>:
    - <span style=color:#ae81ff>ComputerName</span>
    - <span style=color:#ae81ff>User</span>
    - <span style=color:#ae81ff>SourceImage</span>
    - <span style=color:#ae81ff>TargetImage</span>
<span style=color:#f92672>level</span>: <span style=color:#ae81ff>high</span>
<span style=color:#f92672>falsepositives</span>:
    - <span style=color:#ae81ff>Unknown</span>

</code></pre></div></div></div></div><div class="column is-3"><aside class="menu is-medium"><p class=menu-label>Rule Tags</p><div class=tags><a href=https://bradleyjkemp.dev/sigmadoc//tags/attack.privilege_escalation class="tag is-medium">attack.privilege_escalation</a></a>
<a href=https://bradleyjkemp.dev/sigmadoc//tags/attack.defense_evasion class="tag is-medium">attack.defense_evasion</a></a>
<a href=https://bradleyjkemp.dev/sigmadoc//tags/attack.t1055 class="tag is-medium">attack.t1055</a></a></div><ul class=menu-list></ul><p class=menu-label>Similar rules</p><ul class=menu-list><li><a href=/sigmadoc/rules/windows/process_creation/proc_creation_win_malware_dridex.yml/>Dridex Process Pattern</a></li><li><a href=/sigmadoc/rules/windows/powershell/powershell_script/posh_ps_shellcode_b64.yml/>PowerShell ShellCode</a></li><li><a href=/sigmadoc/rules/windows/image_load/image_load_usp_svchost_clfsw32.yml/>APT PRIVATELOG Image Load Pattern</a></li><li><a href=/sigmadoc/rules/windows/pipe_created/pipe_created_mal_cobaltstrike.yml/>CobaltStrike Named Pipe</a></li><li><a href=/sigmadoc/rules/windows/pipe_created/pipe_created_mal_namedpipes.yml/>Malicious Named Pipe</a></li></ul></aside></div></div></div></section><footer class=footer><div class="content has-text-centered"><p>Site generated with <a href=https://github.com/bradleyjkemp/sigmadoc><strong>sigmadoc</strong></a>. The website content
is licensed <a href=https://github.com/SigmaHQ/sigma/blob/master/LICENSE.Detection.Rules.md>DRL 1.0</a>.</p></div></footer></body></html>
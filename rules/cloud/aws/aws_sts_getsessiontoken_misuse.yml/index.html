<!doctype html><html lang=en><head><meta charset=utf-8><title>Sigma Rule Browser</title><meta name=viewport content="width=device-width"><link rel=icon type=image/png sizes=32x32 href=../images/favicon.png><link rel=stylesheet href=https://unpkg.com/bulma@0.9.2/css/bulma.min.css><script src=https://kit.fontawesome.com/7dc3015a44.js crossorigin=anonymous></script></head><body><nav class=navbar role=navigation aria-label="main navigation"><div class=navbar-brand><a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc/>Sigma Docs</a>
<a role=button class=navbar-burger aria-label=menu aria-expanded=false data-target=navbarBasicExample><span aria-hidden=true></span><span aria-hidden=true></span><span aria-hidden=true></span></a></div><div id=navbarBasicExample class=navbar-menu><div class=navbar-start><a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc/>Home</a>
<a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc//rules/>Rules</a>
<a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc//configs/>Configs</a><div class="navbar-item has-dropdown is-hoverable"><a class=navbar-link>Explore rules by...</a><div class=navbar-dropdown><a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc//tags/>Tag</a>
<a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc//status/>Status</a>
<a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc//level/>Level</a></div></div></div><div class=navbar-end><div class=navbar-item id=search class=bd-search><form action=https://bradleyjkemp.dev/sigmadoc//search><p class="control has-icons-left"><input class="input is-rounded" type=text name=query placeholder=Search>
<span class="icon is-left"><i class="fas fa-search" aria-hidden=true></i></span></p></form></div></div></div></nav><section class=section><div class=container><div class=columns><div class="column is-9"><nav class=breadcrumb aria-label=breadcrumbs><ul><li><a href=https://bradleyjkemp.dev/sigmadoc/>home</a></li><li><a href=https://bradleyjkemp.dev/sigmadoc/rules/>rules</a></li><li><a href=https://bradleyjkemp.dev/sigmadoc/rules/cloud/>cloud</a></li><li><a href=https://bradleyjkemp.dev/sigmadoc/rules/cloud/aws/>aws</a></li><li><a href=https://bradleyjkemp.dev/sigmadoc/rules/cloud/aws/aws_sts_getsessiontoken_misuse.yml/>aws_sts_getsessiontoken_misuse.yml</a></li></ul></nav><div class="content is-medium"><h3 class="title is-1">AWS STS GetSessionToken Misuse</h3><div class=box><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-medium is-dark">level</span>
<span class="tag is-medium is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-medium is-dark">status</span>
<span class="tag is-medium is-danger is-light">experimental</span></div></div></div><p>Identifies the suspicious use of GetSessionToken. Tokens could be created and used by attackers to move laterally and escalate privileges.</p><h2 id=known-false-positives>Known false-positives</h2><ul><li>GetSessionToken may be done by a system or network administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. GetSessionToken from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule.</li></ul><h2 id=references>References</h2><ul><li><a href=https://github.com/elastic/detection-rules/pull/1213>https://github.com/elastic/detection-rules/pull/1213</a></li><li><a href=https://docs.aws.amazon.com/STS/latest/APIReference/API_GetSessionToken.html>https://docs.aws.amazon.com/STS/latest/APIReference/API_GetSessionToken.html</a></li></ul><h2 id=raw-rule-edithttpsgithubcomsigmahqsigmaeditmasterrulescloudawsaws_sts_getsessiontoken_misuseyml>Raw rule (<a href=https://github.com/SigmaHQ/sigma/edit/master/rules/cloud/aws/aws_sts_getsessiontoken_misuse.yml>edit</a>)</h2><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>title</span>: <span style=color:#ae81ff>AWS STS GetSessionToken Misuse</span>
<span style=color:#f92672>id</span>: <span style=color:#ae81ff>b45ab1d2-712f-4f01-a751-df3826969807</span>
<span style=color:#f92672>description</span>: <span style=color:#ae81ff>Identifies the suspicious use of GetSessionToken. Tokens could be created and used by attackers to move laterally and escalate privileges.</span>
<span style=color:#f92672>author</span>: <span style=color:#ae81ff>Austin Songer @austinsonger</span>
<span style=color:#f92672>status</span>: <span style=color:#ae81ff>experimental</span>
<span style=color:#f92672>date</span>: <span style=color:#ae81ff>2021</span><span style=color:#ae81ff>/07/24</span>
<span style=color:#f92672>references</span>:
    - <span style=color:#ae81ff>https://github.com/elastic/detection-rules/pull/1213</span>
    - <span style=color:#ae81ff>https://docs.aws.amazon.com/STS/latest/APIReference/API_GetSessionToken.html</span>
<span style=color:#f92672>logsource</span>:
    <span style=color:#f92672>product</span>: <span style=color:#ae81ff>aws</span>
    <span style=color:#f92672>service</span>: <span style=color:#ae81ff>cloudtrail</span>
<span style=color:#f92672>detection</span>:
    <span style=color:#f92672>selection</span>:
        <span style=color:#f92672>eventSource</span>: <span style=color:#ae81ff>sts.amazonaws.com</span>
        <span style=color:#f92672>eventName</span>: <span style=color:#ae81ff>GetSessionToken</span>
        <span style=color:#f92672>userIdentity.type</span>: <span style=color:#ae81ff>IAMUser</span>
    <span style=color:#f92672>condition</span>: <span style=color:#ae81ff>selection</span>
<span style=color:#f92672>level</span>: <span style=color:#ae81ff>low</span>
<span style=color:#f92672>tags</span>:
  - <span style=color:#ae81ff>attack.lateral_movement</span>
  - <span style=color:#ae81ff>attack.privilege_escalation</span>
  - <span style=color:#ae81ff>attack.t1548</span>
  - <span style=color:#ae81ff>attack.t1550</span>
  - <span style=color:#ae81ff>attack.t1550.001</span>
<span style=color:#f92672>falsepositives</span>:
- <span style=color:#ae81ff>GetSessionToken may be done by a system or network administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. GetSessionToken from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule.</span>

</code></pre></div></div></div></div><div class="column is-3"><aside class="menu is-medium"><p class=menu-label>Rule Tags</p><div class=tags><a href=https://bradleyjkemp.dev/sigmadoc//tags/attack.lateral_movement class="tag is-medium">attack.lateral_movement</a></a>
<a href=https://bradleyjkemp.dev/sigmadoc//tags/attack.privilege_escalation class="tag is-medium">attack.privilege_escalation</a></a>
<a href=https://bradleyjkemp.dev/sigmadoc//tags/attack.t1548 class="tag is-medium">attack.t1548</a></a>
<a href=https://bradleyjkemp.dev/sigmadoc//tags/attack.t1550 class="tag is-medium">attack.t1550</a></a>
<a href=https://bradleyjkemp.dev/sigmadoc//tags/attack.t1550.001 class="tag is-medium">attack.t1550.001</a></a></div><ul class=menu-list></ul><p class=menu-label>Similar rules</p><ul class=menu-list><li><a href=/sigmadoc/rules/cloud/aws/aws_sts_assumerole_misuse.yml/>AWS STS AssumeRole Misuse</a></li><li><a href=/sigmadoc/rules/windows/registry_event/registry_event_comhijack_sdclt.yml/>COM Hijack via Sdclt</a></li><li><a href=/sigmadoc/rules/windows/builtin/system/win_vul_cve_2020_1472.yml/>Vulnerable Netlogon Secure Channel Connection Allowed</a></li><li><a href=/sigmadoc/rules/windows/builtin/application/win_audit_cve.yml/>Audit CVE Event</a></li><li><a href=/sigmadoc/rules/windows/builtin/security/win_user_couldnt_call_privileged_service_lsaregisterlogonprocess.yml/>User Couldn't Call a Privileged Service 'LsaRegisterLogonProcess'</a></li></ul></aside></div></div></div></section><footer class=footer><div class="content has-text-centered"><p>Site generated with <a href=https://github.com/bradleyjkemp/sigmadoc><strong>sigmadoc</strong></a>. The website content
is licensed <a href=https://github.com/SigmaHQ/sigma/blob/master/LICENSE.Detection.Rules.md>DRL 1.0</a>.</p></div></footer></body></html>
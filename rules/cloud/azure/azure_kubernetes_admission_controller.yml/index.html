<!doctype html><html lang=en><head><meta charset=utf-8><title>Sigma Rule Browser</title><meta name=viewport content="width=device-width"><link rel=icon type=image/png sizes=32x32 href=../images/favicon.png><link rel=stylesheet href=https://unpkg.com/bulma@0.9.2/css/bulma.min.css><script src=https://kit.fontawesome.com/7dc3015a44.js crossorigin=anonymous></script></head><body><nav class=navbar role=navigation aria-label="main navigation"><div class=navbar-brand><a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc/>Sigma Docs</a>
<a role=button class=navbar-burger aria-label=menu aria-expanded=false data-target=navbarBasicExample><span aria-hidden=true></span><span aria-hidden=true></span><span aria-hidden=true></span></a></div><div id=navbarBasicExample class=navbar-menu><div class=navbar-start><a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc/>Home</a>
<a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc//rules/>Rules</a>
<a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc//configs/>Configs</a><div class="navbar-item has-dropdown is-hoverable"><a class=navbar-link>Explore rules by...</a><div class=navbar-dropdown><a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc//tags/>Tag</a>
<a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc//status/>Status</a>
<a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc//level/>Level</a></div></div></div><div class=navbar-end><div class=navbar-item id=search class=bd-search><form action=https://bradleyjkemp.dev/sigmadoc//search><p class="control has-icons-left"><input class="input is-rounded" type=text name=query placeholder=Search>
<span class="icon is-left"><i class="fas fa-search" aria-hidden=true></i></span></p></form></div></div></div></nav><section class=section><div class=container><div class=columns><div class="column is-9"><nav class=breadcrumb aria-label=breadcrumbs><ul><li><a href=https://bradleyjkemp.dev/sigmadoc/>home</a></li><li><a href=https://bradleyjkemp.dev/sigmadoc/rules/>rules</a></li><li><a href=https://bradleyjkemp.dev/sigmadoc/rules/cloud/>cloud</a></li><li><a href=https://bradleyjkemp.dev/sigmadoc/rules/cloud/azure/>azure</a></li><li><a href=https://bradleyjkemp.dev/sigmadoc/rules/cloud/azure/azure_kubernetes_admission_controller.yml/>azure_kubernetes_admission_controller.yml</a></li></ul></nav><div class="content is-medium"><h3 class="title is-1">Azure Kubernetes Admission Controller</h3><div class=box><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-medium is-dark">level</span>
<span class="tag is-medium is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-medium is-dark">status</span>
<span class="tag is-medium is-danger is-light">experimental</span></div></div></div><p>Identifies when an admission controller is executed in Azure Kubernetes. A Kubernetes Admission controller intercepts, and possibly modifies, requests to the Kubernetes API server. The behavior of this admission controller is determined by an admission webhook (MutatingAdmissionWebhook or ValidatingAdmissionWebhook) that the user deploys in the cluster. An adversary can use such webhooks as the MutatingAdmissionWebhook for obtaining persistence in the cluster. For example, attackers can intercept and modify the pod creation operations in the cluster and add their malicious container to every created pod. An adversary can use the webhook ValidatingAdmissionWebhook, which could be used to obtain access credentials. An adversary could use the webhook to intercept the requests to the API server, record secrets, and other sensitive information.</p><h2 id=known-false-positives>Known false-positives</h2><ul><li>Azure Kubernetes Admissions Controller may be done by a system administrator.</li><li>If known behavior is causing false positives, it can be exempted from the rule.</li></ul><h2 id=references>References</h2><ul><li><a href=https://docs.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations#microsoftkubernetes>https://docs.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations#microsoftkubernetes</a></li></ul><h2 id=raw-rule-edithttpsgithubcomsigmahqsigmaeditmasterrulescloudazureazure_kubernetes_admission_controlleryml>Raw rule (<a href=https://github.com/SigmaHQ/sigma/edit/master/rules/cloud/azure/azure_kubernetes_admission_controller.yml>edit</a>)</h2><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>title</span>: <span style=color:#ae81ff>Azure Kubernetes Admission Controller</span>
<span style=color:#f92672>id</span>: <span style=color:#ae81ff>a61a3c56-4ce2-4351-a079-88ae4cbd2b58</span>
<span style=color:#f92672>description</span>: <span style=color:#ae81ff>Identifies when an admission controller is executed in Azure Kubernetes. A Kubernetes Admission controller intercepts, and possibly modifies, requests to the Kubernetes API server. The behavior of this admission controller is determined by an admission webhook (MutatingAdmissionWebhook or ValidatingAdmissionWebhook) that the user deploys in the cluster. An adversary can use such webhooks as the MutatingAdmissionWebhook for obtaining persistence in the cluster. For example, attackers can intercept and modify the pod creation operations in the cluster and add their malicious container to every created pod. An adversary can use the webhook ValidatingAdmissionWebhook, which could be used to obtain access credentials. An adversary could use the webhook to intercept the requests to the API server, record secrets, and other sensitive information.</span>
<span style=color:#f92672>author</span>: <span style=color:#ae81ff>Austin Songer @austinsonger</span>
<span style=color:#f92672>status</span>: <span style=color:#ae81ff>experimental</span>
<span style=color:#f92672>date</span>: <span style=color:#ae81ff>2021</span><span style=color:#ae81ff>/11/25</span>
<span style=color:#f92672>modified</span>: <span style=color:#ae81ff>2021</span><span style=color:#ae81ff>/11/26</span>
<span style=color:#f92672>references</span>:
    - <span style=color:#ae81ff>https://docs.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations#microsoftkubernetes</span>
<span style=color:#f92672>logsource</span>:
  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>azure</span>
  <span style=color:#f92672>service</span>: <span style=color:#ae81ff>azure.activitylogs</span>
<span style=color:#f92672>detection</span>:
    <span style=color:#f92672>selection1</span>:
          <span style=color:#f92672>properties.message|startswith</span>:
            - <span style=color:#ae81ff>MICROSOFT.KUBERNETES/CONNECTEDCLUSTERS/ADMISSIONREGISTRATION.K8S.IO</span>
          <span style=color:#f92672>properties.message|endswith</span>:
            - <span style=color:#ae81ff>/MUTATINGWEBHOOKCONFIGURATIONS/WRITE</span>
            - <span style=color:#ae81ff>/VALIDATINGWEBHOOKCONFIGURATIONS/WRITE</span>
    <span style=color:#f92672>selection2</span>:
          <span style=color:#f92672>properties.message|startswith</span>:
            - <span style=color:#ae81ff>MICROSOFT.CONTAINERSERVICE/MANAGEDCLUSTERS/ADMISSIONREGISTRATION.K8S.IO</span>
          <span style=color:#f92672>properties.message|endswith</span>:
            - <span style=color:#ae81ff>/MUTATINGWEBHOOKCONFIGURATIONS/WRITE</span>
            - <span style=color:#ae81ff>/VALIDATINGWEBHOOKCONFIGURATIONS/WRITE</span>
    <span style=color:#f92672>condition</span>: <span style=color:#ae81ff>selection1 or selection2</span>
<span style=color:#f92672>level</span>: <span style=color:#ae81ff>medium</span>
<span style=color:#f92672>tags</span>:
    - <span style=color:#ae81ff>attack.persistence</span>
    - <span style=color:#ae81ff>attack.t1078</span>
    - <span style=color:#ae81ff>attack.credential_access</span>
    - <span style=color:#ae81ff>attack.t1552</span>
    - <span style=color:#ae81ff>attack.t1552.007</span>
<span style=color:#f92672>falsepositives</span>:
- <span style=color:#ae81ff>Azure Kubernetes Admissions Controller may be done by a system administrator. </span>
- <span style=color:#ae81ff>If known behavior is causing false positives, it can be exempted from the rule.</span>

</code></pre></div></div></div></div><div class="column is-3"><aside class="menu is-medium"><p class=menu-label>Rule Tags</p><div class=tags><a href=https://bradleyjkemp.dev/sigmadoc//tags/attack.persistence class="tag is-medium">attack.persistence</a></a>
<a href=https://bradleyjkemp.dev/sigmadoc//tags/attack.t1078 class="tag is-medium">attack.t1078</a></a>
<a href=https://bradleyjkemp.dev/sigmadoc//tags/attack.credential_access class="tag is-medium">attack.credential_access</a></a>
<a href=https://bradleyjkemp.dev/sigmadoc//tags/attack.t1552 class="tag is-medium">attack.t1552</a></a>
<a href=https://bradleyjkemp.dev/sigmadoc//tags/attack.t1552.007 class="tag is-medium">attack.t1552.007</a></a></div><ul class=menu-list></ul><p class=menu-label>Similar rules</p><ul class=menu-list><li><a href=/sigmadoc/rules/cloud/gcp/gcp_kubernetes_admission_controller.yml/>Google Cloud Kubernetes Admission Controller</a></li><li><a href=/sigmadoc/rules/cloud/azure/azure_keyvault_secrets_modified_or_deleted.yml/>Azure Keyvault Secrets Modified or Deleted</a></li><li><a href=/sigmadoc/rules/cloud/azure/azure_keyvault_key_modified_or_deleted.yml/>Azure Keyvault Key Modified or Deleted</a></li><li><a href=/sigmadoc/rules/cloud/azure/azure_keyvault_modified_or_deleted.yml/>Azure Key Vault Modified or Deleted.</a></li><li><a href=/sigmadoc/rules/cloud/aws/aws_route_53_domain_transferred_lock_disabled.yml/>AWS Route 53 Domain Transfer Lock Disabled</a></li></ul></aside></div></div></div></section><footer class=footer><div class="content has-text-centered"><p>Site generated with <a href=https://github.com/bradleyjkemp/sigmadoc><strong>sigmadoc</strong></a>. The website content
is licensed <a href=https://github.com/SigmaHQ/sigma/blob/master/LICENSE.Detection.Rules.md>DRL 1.0</a>.</p></div></footer></body></html>
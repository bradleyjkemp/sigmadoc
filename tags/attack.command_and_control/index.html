<!doctype html><html lang=en><head><meta charset=utf-8><title>Sigma Rule Browser</title><meta name=viewport content="width=device-width"><link rel=icon type=image/png sizes=32x32 href=../images/favicon.png><link rel=stylesheet href=https://unpkg.com/bulma@0.9.2/css/bulma.min.css><script src=https://kit.fontawesome.com/7dc3015a44.js crossorigin=anonymous></script></head><body><nav class=navbar role=navigation aria-label="main navigation"><div class=navbar-brand><a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc/>Sigma Docs</a>
<a role=button class=navbar-burger aria-label=menu aria-expanded=false data-target=navbarBasicExample><span aria-hidden=true></span><span aria-hidden=true></span><span aria-hidden=true></span></a></div><div id=navbarBasicExample class=navbar-menu><div class=navbar-start><a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc/>Home</a>
<a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc//rules/>Rules</a>
<a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc//configs/>Configs</a><div class="navbar-item has-dropdown is-hoverable"><a class=navbar-link>Explore rules by...</a><div class=navbar-dropdown><a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc//tags/>Tag</a>
<a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc//status/>Status</a>
<a class=navbar-item href=https://bradleyjkemp.dev/sigmadoc//level/>Level</a></div></div></div><div class=navbar-end><div class=navbar-item id=search class=bd-search><form action=https://bradleyjkemp.dev/sigmadoc//search><p class="control has-icons-left"><input class="input is-rounded" type=text name=query placeholder=Search>
<span class="icon is-left"><i class="fas fa-search" aria-hidden=true></i></span></p></form></div></div></div></nav><section class=section><div class=container><div class=columns><div class="column is-9"><nav class=breadcrumb aria-label=breadcrumbs><ul><li><a href=https://bradleyjkemp.dev/sigmadoc/>home</a></li><li><a href=https://bradleyjkemp.dev/sigmadoc/tags/>tags</a></li><li><a href=https://bradleyjkemp.dev/sigmadoc/tags/attack.command_and_control/>attack.command_and_control</a></li></ul></nav><h3 class="title is-3">attack.command_and_control</h3><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_screenconnect_anomaly.yml/>ScreenConnect Backstage Mode Anomaly</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_screenconnect_anomaly.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects suspicious sub processes started by the ScreenConnect client service, which indicates the use of the so-called Backstage mode</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_tor_browser.yml/>Tor Client or Tor Browser Use</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_tor_browser.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects the use of Tor or Tor-Browser to connect to onion routing networks</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/dns_query/dns_query_win_tor_onion.yml/>Query Tor Onion Address</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/dns_query/dns_query_win_tor_onion.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects DNS resolution of an .onion address related to Tor routing networks</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/file_event/file_event_win_screenconnect_artefact.yml/>ScreenConnect Temporary Installation Artefact</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/file_event/file_event_win_screenconnect_artefact.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.
These services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.
Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/file_event/file_event_win_gotoopener_artefact.yml/>GoToAssist Temporary Installation Artefact</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/file_event/file_event_win_gotoopener_artefact.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.
These services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.
Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/dns_query/dns_query_win_logmein.yml/>Query to LogMeIn Remote Access Software Domain</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/dns_query/dns_query_win_logmein.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.
These services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.
Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/file_event/file_event_win_anydesk_artefact.yml/>Anydesk Temporary Artefact</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/file_event/file_event_win_anydesk_artefact.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.
These services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.
Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/file_event/file_event_win_susp_teamviewer_remote_session.yml/>TeamViewer Remote Session</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/file_event/file_event_win_susp_teamviewer_remote_session.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects the creation of log files during a TeamViewer remote session</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/dns_query/dns_query_win_susp_teamviewer.yml/>Suspicious TeamViewer Domain Access</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/dns_query/dns_query_win_susp_teamviewer.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects DNS queries to a TeamViewer domain only resolved by a TeamViewer client by an image that isn&rsquo;t named TeamViewer (sometimes used by threat actors for obfuscation)</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/file_event/file_event_win_install_teamviewer_desktop.yml/>Installation of TeamViewer Desktop</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/file_event/file_event_win_install_teamviewer_desktop.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>TeamViewer_Desktop.exe is create during install</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/powershell/powershell_script/posh_ps_susp_invoke_webrequest_useragent.yml/>Change User Agents with WebRequest</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/powershell/powershell_script/posh_ps_susp_invoke_webrequest_useragent.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Adversaries may communicate using application layer protocols associated with web traffic to avoid detection/network filtering by blending in with existing traffic.
Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server.</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/powershell/powershell_script/posh_ps_test_netconnection.yml/>Testing Usage of Uncommonly Used Port</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/powershell/powershell_script/posh_ps_test_netconnection.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Adversaries may communicate using a protocol and port paring that are typically not associated.
For example, HTTPS over port 8088(Citation: Symantec Elfin Mar 2019) or port 587(Citation: Fortinet Agent Tesla April 2018) as opposed to the traditional port 443.</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/powershell/powershell_script/posh_ps_susp_ssl_keyword.yml/>Suspicious SSL Connection</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/powershell/powershell_script/posh_ps_susp_ssl_keyword.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Adversaries may employ a known encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol.</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/network_connection/net_connection_win_imewdbld.yml/>Download a File with IMEWDBLD.exe</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/network_connection/net_connection_win_imewdbld.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Use IMEWDBLD.exe (built-in to windows) to download a file</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_msedge_minimized_download.yml/>Suspicious Minimized MSEdge Start</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_msedge_minimized_download.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light"></span></div></div></div></a></header><div class=card-content><div class=content><p>Detects the suspicious minimized start of MsEdge browser, which can be used to download files from the Internet</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_lolbas_diantz_remote_cab.yml/>Suspicious Diantz Download and Compress Into a CAB File</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_lolbas_diantz_remote_cab.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Download and compress a remote file and store it in a cab file on local machine.</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/dns_query/dns_query_win_lobas_appinstaller.yml/>AppInstaller Attempts From URL by DNS</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/dns_query/dns_query_win_lobas_appinstaller.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>AppInstaller.exe is spawned by the default handler for the URI, it attempts to load/install a package from the URL</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_susp_certreq_download.yml/>Suspicious Certreq Command to Download</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_susp_certreq_download.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects a suspicious certreq execution taken from the LOLBAS examples, which can be abused to download (small) files</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/builtin/system/win_apt_chafer_mar18_system.yml/>Chafer Activity</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/builtin/system/win_apt_chafer_mar18_system.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects Chafer activity attributed to OilRig as reported in Nyotron report in March 2018</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/powershell/powershell_module/posh_pm_powercat.yml/>Netcat The Powershell Version</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/powershell/powershell_module/posh_pm_powercat.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Adversaries may use a non-application layer protocol for communication between host and C2 server or among infected hosts within a network</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_netcat_execution.yml/>Ncat Execution</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_netcat_execution.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Adversaries may use a non-application layer protocol for communication between host and C2 server or among infected hosts within a network</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/network/zeek/zeek_default_cobalt_strike_certificate.yml/>Default Cobalt Strike Certificate</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/network/zeek/zeek_default_cobalt_strike_certificate.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects the presence of default Cobalt Strike certificate in the HTTPS traffic</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/registry_event/registry_event_outlook_c2_registry_key.yml/>Outlook C2 Registry Key</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/registry_event/registry_event_outlook_c2_registry_key.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects the modification of Outlook Security Setting to allow unprompted execution. Goes with win_outlook_c2_macro_creation.yml and is particularly interesting if both events occur near to each other.</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/network/net_wannacry_killswitch_domain.yml/>Wannacry Killswitch Domain</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/network/net_wannacry_killswitch_domain.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects wannacry killswitch domain dns queries</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_dnscat2_powershell_implementation.yml/>DNSCat2 Powershell Implementation Detection Via Process Creation</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_dnscat2_powershell_implementation.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>The PowerShell implementation of DNSCat2 calls nslookup to craft queries. Counting nslookup processes spawned by PowerShell will show hundreds or thousands of instances if PS DNSCat2 is active locally.</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_empire_ua_uri_combos.yml/>Empire UserAgent URI Combo</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_empire_ua_uri_combos.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects user agent and URI paths used by empire agents</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/linux/builtin/lnx_file_copy.yml/>Remote File Copy</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/linux/builtin/lnx_file_copy.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-success is-light">stable</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects the use of tools that copy files from or to remote systems</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/builtin/ntlm/win_susp_ntlm_rdp.yml/>Potential Remote Desktop Connection to Non-Domain Host</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/builtin/ntlm/win_susp_ntlm_rdp.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects logons using NTLM to hosts that are potentially not part of the domain.</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/network_connection/net_connection_win_notepad_network_connection.yml/>Notepad Making Network Connection</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/network_connection/net_connection_win_notepad_network_connection.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects suspicious network connection by Notepad</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_pwndrop.yml/>PwnDrp Access</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_pwndrop.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects downloads from PwnDrp web servers developed for red team testing and most likely also used for criminal activity</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/builtin/security/win_susp_ldap_dataexchange.yml/>Suspicious LDAP-Attributes Used</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/builtin/security/win_susp_ldap_dataexchange.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects the usage of particular AttributeLDAPDisplayNames, which are known for data exchange via LDAP by the tool LDAPFragger and are additionally not commonly used in companies.</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/file_event/file_event_win_susp_adsi_cache_usage.yml/>Suspicious ADSI-Cache Usage By Unknown Tool</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/file_event/file_event_win_susp_adsi_cache_usage.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects the usage of ADSI (LDAP) operations by tools. This may also detect tools like LDAPFragger.</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_susp_ps_downloadfile.yml/>PowerShell DownloadFile</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_susp_ps_downloadfile.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects the execution of powershell, a WebClient object creation and the invocation of DownloadFile in a single command line</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_susp_curl_start_combo.yml/>Curl Start Combination</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_susp_curl_start_combo.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Adversaries can use curl to download payloads remotely and execute them. Curl is included by default in Windows 10 build 17063 and later.</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/apt/apt_silence_eda.yml/>Silence.EDA Detection</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/apt/apt_silence_eda.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects Silence empireDNSagent</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/network/cisco/aaa/cisco_cli_moving_data.yml/>Cisco Stage Data</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/network/cisco/aaa/cisco_cli_moving_data.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Various protocols maybe used to put data on the device for exfil or infil</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_susp_msoffice.yml/>Malicious Payload Download via Office Binaries</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_susp_msoffice.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Downloads payload from remote server</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/network/net_high_txt_records_requests_rate.yml/>High TXT Records Requests Rate</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/network/net_high_txt_records_requests_rate.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Extremely high rate of TXT record type DNS requests from host per short period of time. Possible result of Do-exfiltration tool execution</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/network/net_high_null_records_requests_rate.yml/>High NULL Records Requests Rate</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/network/net_high_null_records_requests_rate.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Extremely high rate of NULL record type DNS requests from host per short period of time. Possible result of iodine tool execution</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/network/net_high_dns_requests_rate.yml/>High DNS Requests Rate</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/network/net_high_dns_requests_rate.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>High DNS requests amount from host per short period of time</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/network/net_firewall_high_dns_requests_rate.yml/>High DNS Requests Rate</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/network/net_firewall_high_dns_requests_rate.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>High DNS requests amount from host per short period of time</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_exfiltration_and_tunneling_tools_execution.yml/>Exfiltration and Tunneling Tools Execution</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_exfiltration_and_tunneling_tools_execution.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Execution of well known tools for data exfiltration and tunneling</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_silenttrinity_stage_use.yml/>SILENTTRINITY Stager Execution</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_silenttrinity_stage_use.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects SILENTTRINITY stager use</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_ua_cryptominer.yml/>Crypto Miner User Agent</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_ua_cryptominer.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects suspicious user agent strings used by crypto miners in proxy logs</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/network/net_dns_c2_detection.yml/>Possible DNS Tunneling</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/network/net_dns_c2_detection.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Normally, DNS logs contain a limited amount of different dns queries for a single domain. This rule detects a high amount of queries for a single domain, which can be an indicator that DNS is used to transfer data.</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/builtin/security/win_rdp_reverse_tunnel.yml/>RDP over Reverse SSH Tunnel WFP</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/builtin/security/win_rdp_reverse_tunnel.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects svchost hosting RDP termsvcs communicating with the loopback address</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_chafer_malware.yml/>Chafer Malware URL Pattern</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_chafer_malware.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects HTTP requests used by Chafer malware</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_susp_tscon_localsystem.yml/>Suspicious TSCON Start as SYSTEM</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_susp_tscon_localsystem.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects a tscon.exe start as LOCAL SYSTEM</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_susp_certutil_command.yml/>Suspicious Certutil Command</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_susp_certutil_command.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects a suspicious Microsoft certutil execution with sub commands like &lsquo;decode&rsquo; sub command, which is sometimes used to decode malicious code with the built-in certutil utility</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_susp_msiexec_web_install.yml/>MsiExec Web Install</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_susp_msiexec_web_install.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects suspicious msiexec process starts with web addresses as parameter</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_susp_cmd_http_appdata.yml/>Command Line Execution with Suspicious URL and AppData Strings</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_susp_cmd_http_appdata.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects a suspicious command line execution that includes an URL and AppData string in the command line parameters as used by several droppers (js/vbs > powershell)</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_cobalt_ocsp.yml/>CobaltStrike Malleable (OCSP) Profile</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_cobalt_ocsp.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects Malleable (OCSP) Profile with Typo (OSCP) in URL</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_cobalt_onedrive.yml/>CobaltStrike Malleable OneDrive Browsing Traffic Profile</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_cobalt_onedrive.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects Malleable OneDrive Profile</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/network/net_susp_dns_b64_queries.yml/>Suspicious DNS Query with B64 Encoded String</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/network/net_susp_dns_b64_queries.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects suspicious DNS queries using base64 encoding</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/network/net_mal_dns_cobaltstrike.yml/>Cobalt Strike DNS Beaconing</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/network/net_mal_dns_cobaltstrike.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects suspicious DNS queries known from Cobalt Strike beacons</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/network/net_apt_equationgroup_c2.yml/>Equation Group C2 Communication</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/network/net_apt_equationgroup_c2.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects communication to C2 servers mentioned in the operational notes of the ShadowBroker leak of EquationGroup C2 tools</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/network_connection/net_connection_win_malware_backconnect_ports.yml/>Suspicious Typical Malware Back Connect Ports</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/network_connection/net_connection_win_malware_backconnect_ports.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects programs that connect to typical malware back connect ports based on statistical analysis from two different sandbox system databases</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_downloadcradle_webdav.yml/>Windows WebDAV User Agent</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_downloadcradle_webdav.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects WebDav DownloadCradle</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_powershell_ua.yml/>Windows PowerShell User Agent</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_powershell_ua.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects Windows PowerShell Web Access</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_susp_wuauclt.yml/>Windows Update Client LOLBIN</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_susp_wuauclt.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects code execution via the Windows Update client (wuauclt)</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_ursnif_malware_c2_url.yml/>Ursnif Malware C2 URL Pattern</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_ursnif_malware_c2_url.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-success is-light">stable</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects Ursnif C2 traffic.</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_turla_comrat.yml/>Turla ComRAT</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_turla_comrat.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects Turla ComRAT patterns</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/network/net_susp_telegram_api.yml/>Telegram Bot API Request</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/network/net_susp_telegram_api.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects suspicious DNS queries to api.telegram.org used by Telegram Bots of any kind</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_telegram_api.yml/>Telegram API Access</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_telegram_api.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects suspicious requests to Telegram API without the usual Telegram User-Agent</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_ua_suspicious.yml/>Suspicious User Agent</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_ua_suspicious.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects suspicious malformed user agent strings in proxy logs</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_lolbas_replace.yml/>Suspicious Replace.exe Execution</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_lolbas_replace.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Replace.exe is used to replace file with another file</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_susp_plink_remote_forward.yml/>Suspicious Plink Remote Forwarding</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_susp_plink_remote_forward.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects suspicious Plink tunnel remote forarding to a local port</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/network/zeek/zeek_dns_suspicious_zbit_flag.yml/>Suspicious DNS Z Flag Bit Set</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/network/zeek/zeek_dns_suspicious_zbit_flag.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>The DNS Z flag is bit within the DNS protocol header that is, per the IETF design, meant to be used reserved (unused). Although recently it has been used in DNSSec, the value being set to anything other than 0 should be rare. Otherwise if it is set to non 0 and DNSSec is being used, then excluding the legitimate domains is low effort and high reward. Determine if multiple of these files were accessed in a short period of time to further enhance the possibility of seeing if this was a one off or the possibility of larger sensitive file gathering. This Sigma query is designed to accompany the Corelight Threat Hunting Guide, which can be found here: <a href=https://www3.corelight.com/corelights-introductory-guide-to-threat-hunting-with-zeek-bro-logs>https://www3.corelight.com/corelights-introductory-guide-to-threat-hunting-with-zeek-bro-logs</a></p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_susp_desktopimgdownldr.yml/>Suspicious Desktopimgdownldr Command</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_susp_desktopimgdownldr.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects a suspicious Microsoft desktopimgdownldr execution with parameters used to download files from the Internet</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_susp_curl_download.yml/>Suspicious Curl Usage on Windows</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_susp_curl_download.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects a suspicious curl process start on Windows and outputs the requested document to a local file</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/dns_query/dns_query_win_mal_cobaltstrike.yml/>Suspicious Cobalt Strike DNS Beaconing</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/dns_query/dns_query_win_mal_cobaltstrike.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects a program that invoked suspicious DNS queries known from Cobalt Strike beacons</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/linux/auditd/lnx_auditd_susp_c2_commands.yml/>Suspicious C2 Activities</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/linux/auditd/lnx_auditd_susp_c2_commands.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects suspicious activities as declared by Florian Roth in its &lsquo;Best Practice Auditd Configuration&rsquo;. This includes the detection of the following commands; wget, curl, base64, nc, netcat, ncat, ssh, socat, wireshark, rawshark, rdesktop, nmap. These commands match a few techniques from the tactics &ldquo;Command and Control&rdquo;, including not exhaustively the following; Application Layer Protocol (T1071), Non-Application Layer Protocol (T1095), Data Encoding (T1132)</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_raw_paste_service_access.yml/>Raw Paste Service Access</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_raw_paste_service_access.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects direct access to raw pastes in different paste services often used by malware in their second stages to download malicious code in encrypted or encoded form</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/registry_event/registry_event_portproxy_registry_key.yml/>PortProxy Registry Key</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/registry_event/registry_event_portproxy_registry_key.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects the modification of PortProxy registry key which is used for port forwarding. For command execution see rule win_netsh_port_fwd.yml.</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/file_event/file_event_win_outlook_c2_macro_creation.yml/>Outlook C2 Macro Creation</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/file_event/file_event_win_outlook_c2_macro_creation.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects the creation of a macro file for Outlook. Goes with win_outlook_c2_registry_key. VbaProject.OTM is explicitly mentioned in T1137. Particularly interesting if both events Registry & File Creation happens at the same time.</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_susp_ngrok_pua.yml/>Ngrok Usage</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_susp_ngrok_pua.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects the use of Ngrok, a utility used for port forwarding and tunneling, often used by threat actors to make local protected services publicly available. Involved domains are bin.equinox.io for download and *.ngrok.io for connections.</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_netsh_port_fwd_3389.yml/>Netsh RDP Port Forwarding</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_netsh_port_fwd_3389.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects netsh commands that configure a port forwarding of port 3389 used for RDP</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_netsh_port_fwd.yml/>Netsh Port Forwarding</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_netsh_port_fwd.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects netsh commands that configure a port forwarding (PortProxy)</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_ua_malware.yml/>Malware User Agent</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_ua_malware.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects suspicious user agent strings used by malware in proxy logs</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/file_event/file_event_win_tsclient_filewrite_startup.yml/>Hijack Legit RDP Session to Move Laterally</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/file_event/file_event_win_tsclient_filewrite_startup.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects the usage of tsclient share to place a backdoor on the RDP source machine&rsquo;s startup folder</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_apt_greenbug_may20.yml/>Greenbug Campaign Indicators</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_apt_greenbug_may20.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects tools and process executions as observed in a Greenbug campaign in May 2020</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_susp_file_download_via_gfxdownloadwrapper.yml/>GfxDownloadWrapper.exe Downloads File from Suspicious URL</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_susp_file_download_via_gfxdownloadwrapper.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects when GfxDownloadWrapper.exe downloads file from non standard URL</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_apt_gallium_sha1.yml/>GALLIUM Artefacts</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_apt_gallium_sha1.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects artefacts associated with activity group GALLIUM - Microsoft Threat Intelligence Center indicators released in December 2019.</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_susp_finger_usage.yml/>Finger.exe Suspicious Invocation</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_susp_finger_usage.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects suspicious aged finger.exe tool execution often used in malware attacks nowadays</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_headless_browser_file_download.yml/>File Download with Headless Browser</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_headless_browser_file_download.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light"></span></div></div></div></a></header><div class=card-content><div class=content><p>This is an unusual method to download files. It starts a browser headless and downloads a file from a location. This can be used by threat actors to download files.</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_ua_frameworks.yml/>Exploit Framework User Agent</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_ua_frameworks.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects suspicious user agent strings used by exploit / pentest frameworks like Metasploit in proxy logs</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_empty_ua.yml/>Empty User Agent</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_empty_ua.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects suspicious empty user agent strings in proxy logs</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_download_susp_dyndns.yml/>Download from Suspicious Dyndns Hosts</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_download_susp_dyndns.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects download of certain file types from hosts with dynamic DNS names (selected list)</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_apt_domestic_kitten.yml/>Domestic Kitten FurBall Malware Pattern</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_apt_domestic_kitten.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects specific malware patterns used by FurBall malware linked to Iranian Domestic Kitten APT group</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/network/net_susp_dns_txt_exec_strings.yml/>DNS TXT Answer with Possible Execution Strings</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/network/net_susp_dns_txt_exec_strings.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects strings used in command execution in DNS TXT Answer</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_apt_muddywater_dnstunnel.yml/>DNS Tunnel Technique from MuddyWater</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/windows/process_creation/proc_creation_win_apt_muddywater_dnstunnel.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Detecting DNS tunnel activity for Muddywater actor</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_cobalt_amazon.yml/>CobaltStrike Malleable Amazon Browsing Traffic Profile</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_cobalt_amazon.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects Malleable Amazon Profile</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_cobalt_malformed_uas.yml/>CobaltStrike Malformed UAs in Malleable Profiles</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_cobalt_malformed_uas.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects different malformed user agents used in Malleable Profiles used with Cobalt Strike</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_ua_bitsadmin_susp_tld.yml/>Bitsadmin to Uncommon TLD</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_ua_bitsadmin_susp_tld.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects Bitsadmin connections to domains with uncommon TLDs - <a href=https://twitter.com/jhencinski/status/1102695118455349248>https://twitter.com/jhencinski/status/1102695118455349248</a> - <a href=https://isc.sans.edu/forums/diary/Investigating+Microsoft+BITS+Activity/23281/>https://isc.sans.edu/forums/diary/Investigating+Microsoft+BITS+Activity/23281/</a></p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_baby_shark.yml/>BabyShark Agent Pattern</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_baby_shark.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects Baby Shark C2 Framework communication patterns</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_apt40.yml/>APT40 Dropbox Tool User Agent</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_apt40.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects suspicious user agent string of APT40 Dropbox tool</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_ua_apt.yml/>APT User Agent</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/proxy/proxy_ua_apt.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects suspicious user agent strings used in APT malware in proxy logs</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/application/antivirus/av_exploiting.yml/>Antivirus Exploitation Framework Detection</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/application/antivirus/av_exploiting.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-light is-light">test</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects a highly relevant Antivirus alert that reports an exploitation framework</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/cloud/m365/microsoft365_from_suspicious_ip_addresses.yml/>Activity from Suspicious IP Addresses</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/cloud/m365/microsoft365_from_suspicious_ip_addresses.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects when a Microsoft Cloud App Security reported users were active from an IP address identified as risky by Microsoft Threat Intelligence. These IP addresses are involved in malicious activities, such as Botnet C&C, and may indicate compromised account.</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/cloud/m365/microsoft365_activity_from_infrequent_country.yml/>Activity from Infrequent Country</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/cloud/m365/microsoft365_activity_from_infrequent_country.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects when a Microsoft Cloud App Security reported when an activity occurs from a location that wasn&rsquo;t recently or never visited by any user in the organization.</p></div></div></div><div class="card block"><header class=card-header><a class=card-header-title href=https://bradleyjkemp.dev/sigmadoc/rules/cloud/m365/microsoft365_activity_from_anonymous_ip_addresses.yml/>Activity from Anonymous IP Addresses</a>
<a class=card-header-icon href=https://bradleyjkemp.dev/sigmadoc/rules/cloud/m365/microsoft365_activity_from_anonymous_ip_addresses.yml/><div class="field is-grouped is-justify-content-center"><div class=control><div class="tags has-addons"><span class="tag is-dark">level</span>
<span class="tag is-light"></span></div></div><div class=control><div class="tags has-addons"><span class="tag is-dark">status</span>
<span class="tag is-danger is-light">experimental</span></div></div></div></a></header><div class=card-content><div class=content><p>Detects when a Microsoft Cloud App Security reported when users were active from an IP address that has been identified as an anonymous proxy IP address.</p></div></div></div></div><div class="column is-3"><aside class="is-medium menu"><p class=menu-label>Top Tags</p><div class=tags><div class="field is-grouped is-grouped-multiline"><div class=control><a class="tags has-addons" href=https://bradleyjkemp.dev/sigmadoc//tags/attack.command_and_control><span class="tag is-medium">attack.command_and_control</span>
<span class="tag is-medium">101</span></a></div><div class=control><a class="tags has-addons" href=https://bradleyjkemp.dev/sigmadoc//tags/attack.t1071.001><span class="tag is-medium">attack.t1071.001</span>
<span class="tag is-medium">25</span></a></div><div class=control><a class="tags has-addons" href=https://bradleyjkemp.dev/sigmadoc//tags/attack.t1105><span class="tag is-medium">attack.t1105</span>
<span class="tag is-medium">22</span></a></div><div class=control><a class="tags has-addons" href=https://bradleyjkemp.dev/sigmadoc//tags/attack.defense_evasion><span class="tag is-medium">attack.defense_evasion</span>
<span class="tag is-medium">21</span></a></div><div class=control><a class="tags has-addons" href=https://bradleyjkemp.dev/sigmadoc//tags/attack.t1071.004><span class="tag is-medium">attack.t1071.004</span>
<span class="tag is-medium">13</span></a></div><div class=control><a class="tags has-addons" href=https://bradleyjkemp.dev/sigmadoc//tags/attack.t1219><span class="tag is-medium">attack.t1219</span>
<span class="tag is-medium">12</span></a></div><div class=control><a class="tags has-addons" href=https://bradleyjkemp.dev/sigmadoc//tags/attack.execution><span class="tag is-medium">attack.execution</span>
<span class="tag is-medium">9</span></a></div><div class=control><a class="tags has-addons" href=https://bradleyjkemp.dev/sigmadoc//tags/attack.exfiltration><span class="tag is-medium">attack.exfiltration</span>
<span class="tag is-medium">9</span></a></div><div class=control><a class="tags has-addons" href=https://bradleyjkemp.dev/sigmadoc//tags/attack.lateral_movement><span class="tag is-medium">attack.lateral_movement</span>
<span class="tag is-medium">7</span></a></div><div class=control><a class="tags has-addons" href=https://bradleyjkemp.dev/sigmadoc//tags/attack.t1048.003><span class="tag is-medium">attack.t1048.003</span>
<span class="tag is-medium">6</span></a></div><div class=control><a class="tags has-addons" href=https://bradleyjkemp.dev/sigmadoc//tags/attack.t1059.001><span class="tag is-medium">attack.t1059.001</span>
<span class="tag is-medium">4</span></a></div><div class=control><a class="tags has-addons" href=https://bradleyjkemp.dev/sigmadoc//tags/attack.t1572><span class="tag is-medium">attack.t1572</span>
<span class="tag is-medium">4</span></a></div><div class=control><a class="tags has-addons" href=https://bradleyjkemp.dev/sigmadoc//tags/attack.t1573><span class="tag is-medium">attack.t1573</span>
<span class="tag is-medium">4</span></a></div><div class=control><a class="tags has-addons" href=https://bradleyjkemp.dev/sigmadoc//tags/attack.persistence><span class="tag is-medium">attack.persistence</span>
<span class="tag is-medium">4</span></a></div><div class=control><a class="tags has-addons" href=https://bradleyjkemp.dev/sigmadoc//tags/attack.t1571><span class="tag is-medium">attack.t1571</span>
<span class="tag is-medium">3</span></a></div><div class=control><a class="tags has-addons" href=https://bradleyjkemp.dev/sigmadoc//tags/attack.g0049><span class="tag is-medium">attack.g0049</span>
<span class="tag is-medium">3</span></a></div><div class=control><a class="tags has-addons" href=https://bradleyjkemp.dev/sigmadoc//tags/attack.t1090><span class="tag is-medium">attack.t1090</span>
<span class="tag is-medium">3</span></a></div><div class=control><a class="tags has-addons" href=https://bradleyjkemp.dev/sigmadoc//tags/attack.t1001.003><span class="tag is-medium">attack.t1001.003</span>
<span class="tag is-medium">3</span></a></div><div class=control><a class="tags has-addons" href=https://bradleyjkemp.dev/sigmadoc//tags/attack.t1095><span class="tag is-medium">attack.t1095</span>
<span class="tag is-medium">3</span></a></div><div class=control><a class="tags has-addons" href=https://bradleyjkemp.dev/sigmadoc//tags/attack.t1071><span class="tag is-medium">attack.t1071</span>
<span class="tag is-medium">3</span></a></div></div></div></aside></div></div></div></section><footer class=footer><div class="content has-text-centered"><p>Site generated with <a href=https://github.com/bradleyjkemp/sigmadoc><strong>sigmadoc</strong></a>. The website content
is licensed <a href=https://github.com/SigmaHQ/sigma/blob/master/LICENSE.Detection.Rules.md>DRL 1.0</a>.</p></div></footer></body></html>